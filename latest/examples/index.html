<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="no-js ie6"><![endif]-->
<!--[if IE 7 ]><html class="no-js ie7"><![endif]-->
<!--[if IE 8 ]><html class="no-js ie8"><![endif]-->
<!--[if IE 9 ]><html class="no-js ie9"><![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    
      
        <title>Sample Scripts - BioMedQuery.jl</title>
      
      
      
      
        <meta name="author" content="bcbi">
      
    
    <meta property="og:url" content="None">
    <meta property="og:title" content="BioMedQuery.jl">
    <meta property="og:image" content="None/../images/bcbi_logo.jpeg">
    <meta name="apple-mobile-web-app-title" content="BioMedQuery.jl">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
      <link rel="apple-touch-icon" href="../images/bcbi_logo.jpeg">
    
    
    <link rel="shortcut icon" type="image/x-icon" href="../assets/images/favicon-e565ddfa3b.ico">
    <link rel="icon" type="image/x-icon" href="../assets/images/favicon-e565ddfa3b.ico">
    <style>
      @font-face {
      	font-family: 'Icon';
      	src: url('../assets/fonts/icon.eot?52m981');
      	src: url('../assets/fonts/icon.eot?#iefix52m981')
               format('embedded-opentype'),
      		   url('../assets/fonts/icon.woff?52m981')
               format('woff'),
      		   url('../assets/fonts/icon.ttf?52m981')
               format('truetype'),
      		   url('../assets/fonts/icon.svg?52m981#icon')
               format('svg');
      	font-weight: normal;
      	font-style: normal;
      }
    </style>
    <link rel="stylesheet" href="../assets/stylesheets/application-a422ff04cc.css">
    
    
      
      
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,700|Ubuntu+Mono">
      <style>
        body, input {
          font-family: 'Ubuntu', Helvetica, Arial, sans-serif;
        }
        pre, code {
          font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
        }
      </style>
    
    
      <link rel="stylesheet" href="../assets/Documenter.css">
    
    <script src="../assets/javascripts/modernizr-4ab42b99fd.js"></script>
    
  </head>
  
  
  
  <body class=" ">
    
      
      
    
    <div class="backdrop">
      <div class="backdrop-paper"></div>
    </div>
    <input class="toggle" type="checkbox" id="toggle-drawer">
    <input class="toggle" type="checkbox" id="toggle-search">
    <label class="toggle-button overlay" for="toggle-drawer"></label>
    <header class="header">
      <nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        
          <span class="path">
            
          </span>
        
        Sample Scripts
      </div>
    </div>
    
    
    <div class="button button-search" role="button" aria-label="Search">
      <label class="toggle-button icon icon-search" title="Search" for="toggle-search"></label>
    </div>
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
    </header>
    <main class="main">
      
      <div class="drawer">
        <nav aria-label="Navigation">
  
  <a href="https://github.com/bcbi/BioMedQuery.jl" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="../images/bcbi_logo.jpeg">
        </div>
      
      <div class="name">
        <strong>
          BioMedQuery.jl
          <span class="version">
            
          </span>
        </strong>
        
          <br>
          bcbi/BioMedQuery.jl
        
      </div>
    </div>
  </a>
  <div class="scrollable">
    <div class="wrapper">
      
        <ul class="repo">
          <li class="repo-download">
            
            <a href="https://github.com/bcbi/BioMedQuery.jl/archive/master.zip" target="_blank" title="Download" data-action="download">
              <i class="icon icon-download"></i> Download
            </a>
          </li>
          <li class="repo-stars">
            <a href="https://github.com/bcbi/BioMedQuery.jl/stargazers" target="_blank" title="Stargazers" data-action="star">
              <i class="icon icon-star"></i> Stars
              <span class="count">&ndash;</span>
            </a>
          </li>
        </ul>
        <hr>
      
      <div class="toc">
        <ul>
          
            
  <li>
    <a class="" title="Overview" href="..">
      Overview
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Entrez" href="../entrez/">
      Entrez
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="UMLS" href="../umls/">
      UMLS
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Clinical Trials" href="../ct/">
      Clinical Trials
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Processes/Workflows" href="../processes/">
      Processes/Workflows
    </a>
    
  </li>

          
            
  <li>
    <a class="current" title="Sample Scripts" href="./">
      Sample Scripts
    </a>
    
      
      
        <ul>
          
            <li class="anchor">
              <a title="Running the scripts" href="#running-the-scripts">
                Running the scripts
              </a>
            </li>
          
            <li class="anchor">
              <a title="Configuring local variables" href="#configuring-local-variables">
                Configuring local variables
              </a>
            </li>
          
            <li class="anchor">
              <a title="Search&amp;Save PubMed" href="#searchsave-pubmed">
                Search&amp;Save PubMed
              </a>
            </li>
          
            <li class="anchor">
              <a title="Build MESH-UMLS map" href="#build-mesh-umls-map">
                Build MESH-UMLS map
              </a>
            </li>
          
            <li class="anchor">
              <a title="Occurrence Matrix" href="#occurrence-matrix">
                Occurrence Matrix
              </a>
            </li>
          
            <li class="anchor">
              <a title="Exporting Citations" href="#exporting-citations">
                Exporting Citations
              </a>
            </li>
          
        </ul>
      
    
  </li>

          
            
  <li>
    <a class="" title="Database Utilities" href="../dbutils/">
      Database Utilities
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Library" href="../library/">
      Library
    </a>
    
  </li>

          
        </ul>
        
      </div>
    </div>
  </div>
</nav>
      </div>
      <article class="article">
        <div class="wrapper">
          
            <h1>Sample Scripts</h1>
          
          <p>The <a href="https://github.com/bcbi/BioMedQuery.jl/tree/master/examples">examples</a> folder contains sample scripts demonstrating how to use BioMedQuery's pre-assembled processes/workflows. The following examples are available:</p>
<ul>
<li><a href="./#Search-and-Save-PubMed-1">Search&amp;Save PubMed</a>:  </li>
<li><a href="./#Build-MESH-UMLS-map-1">Build MESH-UMLS map</a>:  </li>
<li><a href="./#Occurrence-Matrix-1">Occurrence Matrix</a>:  </li>
<li><a href="./#Exporting-Citations-1">Exporting Citations</a>:  </li>
</ul>
<p><a id='Running-the-scripts-1'></a></p>
<h2 id="running-the-scripts">Running the scripts</h2>
<p>All scripts can be called from the terminal:</p>
<p><code>julia script_name.jl</code>.</p>
<p><a id='Configuring-local-variables-1'></a></p>
<h2 id="configuring-local-variables">Configuring local variables</h2>
<p>Local paths, database backends, and other variables need to be configured according to you needs, sections containing this local variables are enclosed by the comment lines</p>
<pre><code>#************************ LOCALS TO CONFIGURE!!!! **************************
#***************************************************************************
</code></pre>

<p><strong>User Credentials</strong></p>
<p>Email addresses, passwords or any other type of credentials are expected to be stored in your system as environment variables.</p>
<p>From a Julia session, you can set an environment variable using</p>
<p><code>ENV["MY_PSWD"] = "MyPsWd"</code></p>
<p>However, for this variable to be permanently available, you need to add that line to your <code>~/.juliarc.jl</code> file.</p>
<p><a id='Search-and-Save-PubMed-1'></a></p>
<h2 id="searchsave-pubmed">Search&amp;Save PubMed</h2>
<p>See source file - <a href="https://github.com/bcbi/BioMedQuery.jl/blob/master/examples/pubmed_search_and_save.jl">pubmed_search_and_save.jl</a></p>
<p>It is common to search PubMed for a given number, or all articles associated with a search term, and further store the results to a database, xml or exporting to a citation-style document.</p>
<p>The script <code>pubmed_search_and_save.jl</code> can achieve all that.</p>
<p>The top of the script contains the configuration of the search term, the maximum number of articles to fetch and the format for saving the results. Depending on the "exporting format", there will be other local variables to configure. The results can be saved as:</p>
<ul>
<li>MySQL/SQLite database</li>
<li>XML (raw NCBI response)</li>
<li>Citations: EndNote, BibTEX</li>
</ul>
<p>The main configuration looks as follows:</p>
<pre><code>#************************ LOCALS TO CONFIGURE!!!! **************************
email= ENV[&quot;NCBI_EMAIL&quot;] #This is an enviroment variable that you need to setup
search_term=&quot;(obesity[MeSH Major Topic]) AND (\&quot;2010\&quot;[Date - Publication] : \&quot;2012\&quot;[Date - Publication])&quot;
max_articles = 20
overwrite=true
verbose = false

results_dir = &quot;./results&quot;


#Exporting format
using_sqlite=false
using_mysql=false
using_endnote=false
using_xml=false

#***************************************************************************
</code></pre>

<h3 id="using-mysql">Using MySQL</h3>
<p>If for instance, one wished to save the results to a MySQL database, all we need to do is to set</p>
<p><code>using_mysql = true</code></p>
<p>then, the following code would be executed:</p>
<pre><code>#************************ LOCALS TO CONFIGURE!!!! **************************
host=&quot;localhost&quot; #If want to hide - use enviroment variables instead
mysql_usr=&quot;root&quot;
mysql_pswd=&quot;&quot;
dbname=&quot;pubmed_obesity_2010_2012&quot;
#***************************************************************************
config = Dict(:host=&gt;host,
                 :dbname=&gt;dbname,
                 :username=&gt;mysql_usr,
                 :pswd=&gt;mysql_pswd,
                 :overwrite=&gt;overwrite)
 save_func = save_efetch_mysql

 db = pubmed_search_and_save(email, search_term, max_articles,
 save_func, config, verbose)
</code></pre>

<p><a id='Build-MESH-UMLS-map-1'></a></p>
<h2 id="build-mesh-umls-map">Build MESH-UMLS map</h2>
<p>See source file - <a href="https://github.com/bcbi/BioMedQuery.jl/blob/master/examples/pubmed_mesh_to_umls_map.jl">pubmed_mesh_to_umls_map.jl</a></p>
<p>All PubMed articles are associated with MESH descriptors. This script looks for all mesh descriptors in a results database (as created in pubmed_search_and_save.jl) and finds the UMLS concept associated with that descriptor.</p>
<p>All MESH-UMLS relations are saved in a new (unless set to append) database table called MESH2UMLS.</p>
<p>The user is responsible for configuring the environment variables containing the UMLS credentials:</p>
<pre><code>user = ENV[&quot;UMLS_USER&quot;]
psswd = ENV[&quot;UMLS_PSSWD&quot;]
</code></pre>

<p>And specifying the type and name of the database used to get the MESH and stored the MESH2UMLS.</p>
<p><a id='Occurrence-Matrix-1'></a></p>
<h2 id="occurrence-matrix">Occurrence Matrix</h2>
<p>See source file - <a href="https://github.com/bcbi/BioMedQuery.jl/blob/master/examples/umls_semantic_occurrences.jl">umls_semantic_occurrences.jl</a></p>
<p>This script finds all MESH descriptors of a given UMLS semantic type and builds the corresponding occurrance/data matrix as follows</p>
<p>Suppose we wish to find all MESH descriptors in all articles in our database associated with the UMLS Semantic Type: "Disease or Syndrome"</p>
<p>Suppose we have a total of 4 articles and after filtering the MESH descriptors we have 3 descriptors. Further suppose that:</p>
<ul>
<li>The first article is associated with "diabetes mellitus, type 2" and "pediatric obesity"</li>
<li>The second article is associated with "pediatric obesity"</li>
<li>The third article is associate with "metabolic syndrome x"</li>
<li>The fourth article is not associated with any "Disease or Syndrome"</li>
</ul>
<p>Then the Data Matrix would corresponds to</p>
<table>
<thead>
<tr>
<th align="right">MESH(down)/ARTICLE(right)</th>
<th align="right">A1</th>
<th align="right">A2</th>
<th align="right">A3</th>
<th align="right">A4</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">metabolic syndrome x</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr>
<td align="right">diabetes mellitus, type 2</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr>
<td align="right">pediatric obesity</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<h3 id="output-files">Output Files</h3>
<p>This script will save two files two files to disk in the specified output directory:</p>
<ul>
<li><code>occur_sp.jdl</code>: Binary file containing the sparse datamatrix in variable <code>occur</code></li>
<li><code>labels2ind.jdl</code>: Binary file containing the row index to descriptor label dictionary inside variable <code>labels2ind</code></li>
</ul>
<p>To load back these variable into julia use JDL package. e.g,</p>
<pre><code>using JDL
file  = jldopen(&quot;occur_sp.jdl&quot;, &quot;r&quot;)
data_matrix = read(file, &quot;occur&quot;)
</code></pre>

<p><a id='Exporting-Citations-1'></a></p>
<h2 id="exporting-citations">Exporting Citations</h2>
<p>See source file - <a href="https://github.com/bcbi/BioMedQuery.jl/blob/master/examples/pubmed_export_citations.jl">pubmed_export_citations.jl</a></p>
<p>BioMedQuery.Processes provides ready to use functions that save to EndNote/BibTEX formats the citations associated with a single PMID or a list of PMIDs. If you wish to search PubMed using a search-term and save the results as citations, refer to Examples/pubmed_search_and_save.jl</p>
<p>Exporting citations requires configuring Entrez, email, output file and citation type. For instance,</p>
<pre><code>using BioMedQuery.Processes

results_dir = &quot;./results&quot;

 if !isdir(results_dir)
     mkdir(results_dir)
 end

email= ENV[&quot;NCBI_EMAIL&quot;] #This is an enviroment variable that you need to setup
citation_type=&quot;endnote&quot;
pmid = 11748933
output_file=results_dir*&quot;/11748933.enw&quot;

export_citation(email, pmid, citation_type, output_file)

</code></pre>
          <aside class="copyright" role="note">
            
            Documentation built with
            <a href="http://www.mkdocs.org" target="_blank">MkDocs</a>
            using the
            <a href="http://squidfunk.github.io/mkdocs-material/" target="_blank">
              Material
            </a>
            theme.
          </aside>
          
            <footer class="footer">
              
  <nav class="pagination" aria-label="Footer">
    <div class="previous">
      
        <a href="../processes/" title="Processes/Workflows">
          <span class="direction">
            Previous
          </span>
          <div class="page">
            <div class="button button-previous" role="button" aria-label="Previous">
              <i class="icon icon-back"></i>
            </div>
            <div class="stretch">
              <div class="title">
                Processes/Workflows
              </div>
            </div>
          </div>
        </a>
      
    </div>
    <div class="next">
      
        <a href="../dbutils/" title="Database Utilities">
          <span class="direction">
            Next
          </span>
          <div class="page">
            <div class="stretch">
              <div class="title">
                Database Utilities
              </div>
            </div>
            <div class="button button-next" role="button" aria-label="Next">
              <i class="icon icon-forward"></i>
            </div>
          </div>
        </a>
      
    </div>
  </nav>

            </footer>
          
        </div>
      </article>
      <div class="results" role="status" aria-live="polite">
        <div class="scrollable">
          <div class="wrapper">
            <div class="meta"></div>
            <div class="list"></div>
          </div>
        </div>
      </div>
    </main>
    <script>
      var base_url = '..';
      var repo_id  = 'bcbi/BioMedQuery.jl';
    </script>
    <script src="../assets/javascripts/application-997097ee0c.js"></script>
    
      <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
      <script src="../assets/mathjaxhelper.js"></script>
    
    
  </body>
</html>